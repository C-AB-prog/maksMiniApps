<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MiniApps — Chat & Tasks</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:0; background:#0b0c10; color:#e8eef2; }
    header { padding:16px; display:flex; gap:12px; align-items:center; border-bottom:1px solid #1f2937; }
    .badge { font-size:12px; padding:4px 8px; border-radius:999px; background:#1f2937; }
    .badge.ok { background:#0f5132; } .badge.off { background:#613d3d; }
    main { display:grid; grid-template-columns:1fr; gap:16px; padding:16px; max-width:820px; margin:0 auto; }
    .card { background:#111827; border:1px solid #1f2937; border-radius:16px; padding:12px; }
    .row { display:flex; gap:8px; } .col { display:flex; flex-direction:column; gap:8px; }
    #chatLog { max-height:50vh; overflow:auto; display:flex; flex-direction:column; gap:8px; padding:8px; background:#0e1621; border-radius:12px; }
    .msg { padding:8px 10px; border-radius:10px; max-width:80%; }
    .msg.user { align-self:flex-end; background:#1f2937; }
    .msg.assistant { align-self:flex-start; background:#0b3b2e; }
    input, button, textarea { background:#0b0c10; color:#e8eef2; border:1px solid #293241; border-radius:10px; padding:10px; }
    button { cursor:pointer; }
    small { color:#93a4b0; } .muted { color:#93a4b0; }
    label { font-size:12px; color:#93a4b0; }
    .grid2 { display:grid; grid-template-columns:1fr auto; gap:8px; }
    .taskitem { display:grid; grid-template-columns:auto 1fr auto; gap:8px; align-items:center; padding:6px 8px; border-radius:8px; }
    .taskitem:hover { background:#0f172a; }
  </style>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <header>
    <strong>MiniApps</strong>
    <span id="badge" class="badge off">offline</span>
    <span class="badge" id="who">tg_id: —</span>
  </header>

  <main>
    <section class="card">
      <div class="col">
        <div class="grid2">
          <input id="tgInput" placeholder="tg_id (на ПК для теста; в Telegram подставится сам)" />
          <button id="saveTg">Сохранить</button>
        </div>
        <small class="muted">В Telegram WebApp user.id берётся автоматически. В браузере на ПК — из поля или параметра ?tg_id=.</small>
      </div>
    </section>

    <section class="card">
      <h3>Фокус дня</h3>
      <div class="row">
        <input id="focusInput" placeholder="Что главное сегодня?" style="flex:1" />
        <button id="saveFocus">Сохранить</button>
      </div>
      <small class="muted">Синхронизируется по аккаунту (tg_id).</small>
    </section>

    <section class="card">
      <h3>Чат</h3>
      <div id="chatLog"></div>
      <div class="row" style="margin-top:8px;">
        <input id="msg" placeholder="Напишите сообщение..." style="flex:1" />
        <button id="send">Отправить</button>
      </div>
    </section>

    <section class="card">
      <h3>Задачи</h3>
      <div class="row">
        <input id="taskTitle" placeholder="Название задачи" style="flex:1" />
        <input id="taskDue" type="datetime-local" />
        <button id="addTask">Добавить</button>
      </div>
      <div id="tasks" style="margin-top:8px;"></div>
    </section>
  </main>

  <script src="./main.js"></script>
</body>
</html>
